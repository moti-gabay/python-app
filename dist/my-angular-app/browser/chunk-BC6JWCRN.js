import{a as $}from"./chunk-Q4HXHNX7.js";import{a as F}from"./chunk-TKWG22UM.js";import{$ as g,$b as U,C as h,Eb as y,Gb as I,Ia as c,L as O,Ma as b,Nb as A,Ra as M,Va as p,Yb as L,Zb as T,aa as v,ac as V,cb as s,db as r,eb as i,fb as P,gb as w,hb as S,ib as m,jb as f,kb as l,n as x,sb as k,ub as a,vb as _,wb as E,x as C,y as D}from"./chunk-EYTP6OYD.js";function j(n,o){n&1&&(r(0,"div",6),a(1," \u05D8\u05D5\u05E2\u05DF \u05D0\u05D9\u05E8\u05D5\u05E2\u05D9\u05DD... "),i())}function N(n,o){if(n&1){let e=m();r(0,"div",7),a(1),r(2,"button",8),f("click",function(){g(e);let d=l();return v(d.fetchEvents())}),a(3,"\u05E0\u05E1\u05D4 \u05E9\u05D5\u05D1"),i()()}if(n&2){let e=l();c(),E(" ",e.error," ")}}function B(n,o){n&1&&(r(0,"th"),a(1,"\u05D3\u05E8\u05D9\u05E9\u05D5\u05EA \u05DE\u05EA\u05E0\u05D3\u05D1\u05D9\u05DD"),i())}function q(n,o){n&1&&(r(0,"th"),a(1,"\u05E1\u05D8\u05D8\u05D5\u05E1 \u05D0\u05D9\u05E9\u05D5\u05E8"),i())}function G(n,o){n&1&&P(0,"td")}function H(n,o){if(n&1&&(r(0,"td")(1,"span"),a(2),i()()),n&2){let e=l().$implicit;c(),k("approved",e.is_approved)("pending",!e.is_approved),c(),E(" ",e.is_approved?"\u05DE\u05D0\u05D5\u05E9\u05E8":"\u05DE\u05DE\u05EA\u05D9\u05DF"," ")}}function J(n,o){if(n&1){let e=m();r(0,"button",17),f("click",function(){g(e);let d=l(2).$implicit,u=l(2);return v(u.approveEvent(d._id,d))}),a(1," \u05D0\u05E9\u05E8 "),i()}}function K(n,o){if(n&1){let e=m();r(0,"button",18),f("click",function(){g(e);let d=l(2).$implicit,u=l(2);return v(u.unapproveEvent(d._id))}),a(1," \u05D1\u05D8\u05DC \u05D0\u05D9\u05E9\u05D5\u05E8 "),i()}}function Q(n,o){if(n&1){let e=m();w(0),p(1,J,2,0,"button",14)(2,K,2,0,"button",15),r(3,"button",16),f("click",function(){g(e);let d=l().$implicit,u=l(2);return v(u.deleteEvent(d._id))}),a(4," \u05DE\u05D7\u05E7 "),i(),S()}if(n&2){let e=l().$implicit;c(),s("ngIf",!e.is_approved),c(),s("ngIf",e.is_approved)}}function W(n,o){if(n&1&&(r(0,"tr")(1,"td"),a(2),i(),r(3,"td"),a(4),y(5,"date"),i(),r(6,"td"),a(7),i(),r(8,"td"),a(9),i(),r(10,"td"),a(11),i(),p(12,G,1,0,"td",11)(13,H,3,5,"td",11),r(14,"td",13),p(15,Q,5,2,"ng-container",11),i()()),n&2){let e=o.$implicit,t=l(2);c(2),_(e.title),c(2),_(I(5,8,e.date,"shortDate")),c(3),_(e.time),c(2),_(e.location),c(2),_(e.description),c(),s("ngIf",(t.currentUser==null?null:t.currentUser.role)==="admin"),c(),s("ngIf",(t.currentUser==null?null:t.currentUser.role)==="admin"),c(2),s("ngIf",(t.currentUser==null?null:t.currentUser.role)==="admin")}}function X(n,o){if(n&1&&(r(0,"div",9)(1,"table",10)(2,"thead")(3,"tr")(4,"th"),a(5,"\u05DB\u05D5\u05EA\u05E8\u05EA"),i(),r(6,"th"),a(7,"\u05EA\u05D0\u05E8\u05D9\u05DA"),i(),r(8,"th"),a(9,"\u05E9\u05E2\u05D4"),i(),r(10,"th"),a(11,"\u05DE\u05D9\u05E7\u05D5\u05DD"),i(),r(12,"th"),a(13,"\u05EA\u05D9\u05D0\u05D5\u05E8"),i(),p(14,B,2,0,"th",11)(15,q,2,0,"th",11),r(16,"th"),a(17,"\u05E4\u05E2\u05D5\u05DC\u05D5\u05EA"),i()()(),r(18,"tbody"),p(19,W,16,11,"tr",12),i()()()),n&2){let e=l();c(14),s("ngIf",(e.currentUser==null?null:e.currentUser.role)==="admin"),c(),s("ngIf",(e.currentUser==null?null:e.currentUser.role)==="admin"),c(4),s("ngForOf",e.events)}}function Z(n,o){n&1&&(r(0,"div",19),a(1," \u05D0\u05D9\u05DF \u05D0\u05D9\u05E8\u05D5\u05E2\u05D9\u05DD \u05E7\u05E8\u05D5\u05D1\u05D9\u05DD \u05DC\u05D4\u05E6\u05D2\u05D4. "),i())}var R=class n{constructor(o,e,t){this.eventService=o;this.cdr=e;this.authService=t}events=[];loading=!0;error="";currentUser=null;ngOnInit(){this.authService.currentUser$.pipe(C(o=>o!==null)).subscribe(o=>{this.currentUser=o,this.fetchEvents()})}fetchEvents(){this.loading=!0,this.error="",this.eventService.getEvents().subscribe({next:o=>{let e=new Date;this.currentUser&&this.currentUser.role==="admin"?this.events=o:this.events=o.filter(t=>t.is_approved&&t.date&&new Date(t.date)>=e),this.loading=!1,this.cdr.detectChanges()},error:o=>{this.error=o.error?.message||"\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D8\u05E2\u05D9\u05E0\u05EA \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2\u05D9\u05DD.",this.loading=!1,console.error("Error fetching events:",o)}})}approveEvent(o,e){confirm("\u05D4\u05D0\u05DD \u05D0\u05EA\u05D4 \u05D1\u05D8\u05D5\u05D7 \u05E9\u05D1\u05E8\u05E6\u05D5\u05E0\u05DA \u05DC\u05D0\u05E9\u05E8 \u05D0\u05EA \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2?")&&this.eventService.approveEvent(o).subscribe({next:()=>{alert("\u05D4\u05D0\u05D9\u05E8\u05D5\u05E2 \u05D0\u05D5\u05E9\u05E8 \u05D1\u05D4\u05E6\u05DC\u05D7\u05D4."),this.fetchEvents(),e.created_by&&this.authService.getAllUsers().pipe(h(1),O(t=>{let u=(Array.isArray(t)?t:Object.values(t)).find(Y=>Y._id===e.created_by);if(!u)throw new Error("\u05DC\u05D0 \u05E0\u05DE\u05E6\u05D0 \u05D9\u05D5\u05E6\u05E8 \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2");let z={recipient_email:u.email,event_title:e.title,event_date:e.date,event_time:e.time,event_location:e.location,creator_name:u.name};return this.eventService.sendMailToCreatorEvent(z)}),D(t=>(console.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05E9\u05DC\u05D9\u05E4\u05EA \u05D9\u05D5\u05E6\u05E8 \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2 \u05D0\u05D5 \u05E9\u05DC\u05D9\u05D7\u05EA \u05DE\u05D9\u05D9\u05DC:",t),x(()=>new Error("\u05E9\u05DC\u05D9\u05D7\u05EA \u05DE\u05D9\u05D9\u05DC \u05E0\u05DB\u05E9\u05DC\u05D4"))))).subscribe({next:()=>{},error:t=>{console.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05E9\u05DC\u05D9\u05D7\u05EA \u05D4\u05DE\u05D9\u05D9\u05DC:",t)}})},error:t=>{console.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D0\u05D9\u05E9\u05D5\u05E8 \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2:",t),alert("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D0\u05D9\u05E9\u05D5\u05E8 \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2.")}})}unapproveEvent(o){confirm("\u05D4\u05D0\u05DD \u05D0\u05EA\u05D4 \u05D1\u05D8\u05D5\u05D7 \u05E9\u05D1\u05E8\u05E6\u05D5\u05E0\u05DA \u05DC\u05D1\u05D8\u05DC \u05D0\u05EA \u05D0\u05D9\u05E9\u05D5\u05E8 \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2?")&&this.eventService.unapproveEvent(o).subscribe({next:()=>{this.fetchEvents()},error:e=>{console.error("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D1\u05D9\u05D8\u05D5\u05DC \u05D0\u05D9\u05E9\u05D5\u05E8 \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2:",e),alert("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D1\u05D9\u05D8\u05D5\u05DC \u05D0\u05D9\u05E9\u05D5\u05E8 \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2.")}})}deleteEvent(o){confirm("\u05D0\u05EA\u05D4 \u05D1\u05D8\u05D5\u05D7 \u05E9\u05D1\u05E8\u05E6\u05D5\u05E0\u05DA \u05DC\u05DE\u05D7\u05D5\u05E7 \u05D0\u05EA \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2?")&&this.eventService.deleteEvent(o).subscribe({next:()=>{this.fetchEvents()},error:e=>{console.log("\u05D0\u05D9\u05E8\u05E2\u05D4 \u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D6\u05DE\u05DF \u05DE\u05D7\u05D9\u05E7\u05EA \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2",e),alert("\u05D0\u05D9\u05E8\u05E2\u05D4 \u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D6\u05DE\u05DF \u05DE\u05D7\u05D9\u05E7\u05EA \u05D4\u05D0\u05D9\u05E8\u05D5\u05E2")}})}static \u0275fac=function(e){return new(e||n)(b($),b(A),b(F))};static \u0275cmp=M({type:n,selectors:[["app-event-list"]],decls:7,vars:4,consts:[[1,"events-container"],[1,"events-page-title"],["class","loading-message",4,"ngIf"],["class","error-message",4,"ngIf"],["class","events-table-wrapper",4,"ngIf"],["class","no-events-message",4,"ngIf"],[1,"loading-message"],[1,"error-message"],[3,"click"],[1,"events-table-wrapper"],[1,"events-table"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"actions-cell"],["class","action-button approve-button",3,"click",4,"ngIf"],["class","action-button unapprove-button",3,"click",4,"ngIf"],[1,"action-button","delete-button",3,"click"],[1,"action-button","approve-button",3,"click"],[1,"action-button","unapprove-button",3,"click"],[1,"no-events-message"]],template:function(e,t){e&1&&(r(0,"div",0)(1,"h2",1),a(2,"\u05D0\u05D9\u05E8\u05D5\u05E2\u05D9\u05DD \u05E7\u05E8\u05D5\u05D1\u05D9\u05DD"),i(),p(3,j,2,0,"div",2)(4,N,4,1,"div",3)(5,X,20,3,"div",4)(6,Z,2,0,"div",5),i()),e&2&&(c(3),s("ngIf",t.loading),c(),s("ngIf",t.error),c(),s("ngIf",!t.loading&&!t.error&&t.events.length>0),c(),s("ngIf",!t.loading&&!t.error&&t.events.length===0))},dependencies:[V,L,T,U],styles:['.events-container[_ngcontent-%COMP%]{max-width:1200px;margin:2rem auto;padding:1.5rem;background-color:#f7fafc;border-radius:12px;box-shadow:0 5px 15px #0000001a;direction:rtl;text-align:right;font-family:Inter,sans-serif}.events-page-title[_ngcontent-%COMP%]{font-size:clamp(1.8rem,5vw,2.5rem);color:#2d3748;margin-bottom:1.5rem;font-weight:700;text-align:center;border-bottom:2px solid #3498db;padding-bottom:.8rem}.loading-message[_ngcontent-%COMP%], .error-message[_ngcontent-%COMP%], .no-events-message[_ngcontent-%COMP%]{text-align:center;padding:20px;margin:20px 0;border-radius:8px;font-size:1.1em}.loading-message[_ngcontent-%COMP%]{background-color:#e0f7fa;color:#00796b;border:1px solid #b2ebf2}.error-message[_ngcontent-%COMP%]{background-color:#ffe0b2;color:#e65100;border:1px solid #ffcc80}.error-message[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background-color:#e65100;color:#fff;border:none;padding:10px 15px;border-radius:5px;cursor:pointer;margin-top:10px;font-size:.9em;transition:background-color .3s ease}.error-message[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background-color:#ff7043}.no-events-message[_ngcontent-%COMP%]{background-color:#f0f0f0;color:#555;border:1px solid #ddd}.events-table-wrapper[_ngcontent-%COMP%]{overflow-x:auto;margin-top:20px}.events-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;margin-bottom:20px;background-color:#fff;border-radius:8px;overflow:hidden;box-shadow:0 2px 8px #0000001a}.events-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 15px;text-align:right;border-bottom:1px solid #e0e0e0}.events-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#3498db;color:#fff;font-weight:700;font-size:1em;white-space:nowrap}.events-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:nth-child(2n){background-color:#f8f8f8}.events-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f0f8ff}.approved[_ngcontent-%COMP%]{color:#28a745;font-weight:700}.pending[_ngcontent-%COMP%]{color:#ffc107;font-weight:700}.actions-cell[_ngcontent-%COMP%]{white-space:nowrap}.action-button[_ngcontent-%COMP%]{padding:8px 12px;margin:0 5px;border:none;border-radius:5px;cursor:pointer;font-size:.85em;font-weight:600;transition:background-color .3s ease,transform .2s ease}.approve-button[_ngcontent-%COMP%]{background-color:#28a745;color:#fff}.approve-button[_ngcontent-%COMP%]:hover{background-color:#218838;transform:translateY(-2px)}.unapprove-button[_ngcontent-%COMP%]{background-color:#ffc107;color:#333}.unapprove-button[_ngcontent-%COMP%]:hover{background-color:#e0a800;transform:translateY(-2px)}.delete-button[_ngcontent-%COMP%]{background-color:#dc3545;color:#fff}.delete-button[_ngcontent-%COMP%]:hover{background-color:#c82333;transform:translateY(-2px)}.register-button[_ngcontent-%COMP%]{background-color:#007bff;color:#fff}.register-button[_ngcontent-%COMP%]:hover{background-color:#0056b3;transform:translateY(-2px)}.unregister-button[_ngcontent-%COMP%]{background-color:#6c757d;color:#fff}.unregister-button[_ngcontent-%COMP%]:hover{background-color:#5a6268;transform:translateY(-2px)}@media (max-width: 768px){.events-container[_ngcontent-%COMP%]{padding:1rem;margin:1rem auto}.events-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}.events-table[_ngcontent-%COMP%], .events-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%], .events-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%], .events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{display:block;width:100%}.events-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{margin-bottom:1rem;border:1px solid #e0e0e0;border-radius:8px;box-shadow:0 1px 3px #0000001a}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{text-align:right;padding-left:50%;position:relative}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:before{content:attr(data-label);position:absolute;right:15px;width:45%;padding-left:10px;font-weight:700;text-align:left;color:#555}.events-table[_ngcontent-%COMP%]   td.actions-cell[_ngcontent-%COMP%]:before{content:"";display:none}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(1):before{content:"\\5db\\5d5\\5ea\\5e8\\5ea:"}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(2):before{content:"\\5ea\\5d0\\5e8\\5d9\\5da:"}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(3):before{content:"\\5e9\\5e2\\5d4:"}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(4):before{content:"\\5de\\5d9\\5e7\\5d5\\5dd:"}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(5):before{content:"\\5ea\\5d9\\5d0\\5d5\\5e8:"}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(6):before{content:"\\5d9\\5d5\\5e6\\5e8  \\5d4\\5d0\\5d9\\5e8\\5d5\\5e2:"}.events-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-of-type(7):before{content:"\\5e1\\5d8\\5d8\\5d5\\5e1  \\5d0\\5d9\\5e9\\5d5\\5e8:"}}']})};export{R as a};
